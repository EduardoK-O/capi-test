<?php

namespace App\Repositories;

use App\Repositories\Interfaces\ContactoRepositoryInterface;
use App\Models\Contacto;
use Illuminate\Database\Eloquent\ModelNotFoundException;

class ContactoRepository implements ContactoRepositoryInterface{
    public function getAllContactos() {
        return Contacto::all();
    }

    public function getContactoById($id) {
        // Retorna null si no se encuentra el contacto
        $contacto = Contacto::find($id);
        if (!$contacto) {
            throw new ModelNotFoundException("Contacto not found.");
        }
        return $contacto;
    }

    public function createContacto(array $data) {
        // Retorna la instancia del contacto creado
        return Contacto::create($data);
    }

    public function updateContacto($id, array $data) {
        // Verifica si el contacto existe antes de actualizar
        $contacto = Contacto::find($id);
        if (!$contacto) {
            throw new ModelNotFoundException("Contacto not found.");
        }
        
        // Actualiza el contacto y retorna el resultado
        $contacto->update($data);
        return $contacto;
    }

    public function deleteContacto($id) {
        // Verifica si el contacto existe antes de eliminar
        $contacto = Contacto::find($id);
        if (!$contacto) {
            throw new ModelNotFoundException("Contacto not found.");
        }

        // Elimina el contacto y retorna el resultado
        return $contacto->delete();
    }
}